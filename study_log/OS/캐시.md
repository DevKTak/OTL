# CPU 캐시
> **속도가 빠른 장치와 느린 장치 간의 속도차에 따른 병목 현상을 줄이기 위한 범용 메모리입니다.**
- CPU에서 메모리까지의 접근을 줄이기 위해 사용하는 CPU 내부의 메모리이며, **캐시 적중률**을 높이기 위해서 시간지역성이나 공간지역성 같은 지역성의 원리를 이용합니다.

## 지역성(Locality)의 원리
**`시간지역성`**: 최근에 참조된 데이터가 곧 다시 참조되는 특성 ex) for, while   
**`공간지역성`**: 최근에 참조된 데이터와 인접한 데이터가 참조될 가능성이 높은 특성 ex) a[0], a[1]

## 캐시 히트(Cache Hit)
CPU가 참조하고자 하는 메모리가 캐시에 존재하고 있을 경우

## 캐시 미스(Cache Miss)
CPU가 참조하고자 하는 메모리가 캐시에 존재하지 않을 경우

## 캐시 라인
CPU가 메모리에서 데이터를 가져올 때 하나의 바이트 단위로 가져오지 않고 어떤 크기만큼 가져오게 되는데 이 크기를 캐시라인이라고 하고 **캐시라인을 사용하는 이유**는 공간지역성을 활용하여 CPU에서 메모리 접근횟수를 줄임으로써 성능을 향상 시키려는 이유가 있습니다.

### 직접 매핑(Direct Mapping)
- **메모리 주소와 캐시의 순서를 일치** 시켜 지정된 캐시 라인으로만 매핑하는 방식
- 적중률과 성능이 낮지만 구현이 간단하고 쉬운 방법

### 연관 매핑(Associative Mapping)
- **순서를 일치시키지 않고 필요한 메모리 값을 캐시의 어디든 편하게 저장**하는 방식
- 찾는 과정은 복잡하고 느리지만 필요한 캐시 위주로 저장하기에 적중률은 높음

### 직접 연관 매핑(Set Associative Mapping)
- 연관매핑과 직접매핑을 합쳐놓은 방식
- **순서를 일치시키면서 일정 그룹을 두지만, 그 그룹내에서는 편하게 저장**하는 방식

## L1, L2, L3 캐시
캐시는 SRAM으로 이루어지며, SRAM은 집적도가 낮아 용량대비 가격이 매우 비쌉니다.    
따라서 캐시를 3단계의 레벨로 나누어 사용합니다. 레벨이 커질 수록 속도는 느려지고, 메모리 용량은 커지게 됩니다.

### L1 캐시
- 프로세서와 가장 가까운 캐시  
- 속도를 위해 I$ 와 D$ 로 나눔   
- I$ (Instruction Cache) : 메모리의 텍스트 영역 데이터를 다루는 캐시   
- D$ (Data Cache) : 텍스트 영역을 제외한 모든 데이터를 다루는 캐시   

### L2 캐시
- 용량이 큰 캐시 
- 크기를 위해 L1 캐시처럼 나누지 않음

### L3 캐시
- 멀티 코어 시스템에서 여러 코어가 공유하는 캐시   
- 캐시에 달러 기호 $ 를 사용하는 이유는 Cache 와 현금을 뜻하는 Cash 의 발음이 같기 때문입니다.

### CPU에서는 L1, L2, L3 캐시 순으로 데이터를 탐색하며 (L은 level의 약자입니다.)
- 데이터를 찾지 못할 경우 순차적으로 L1 -> L2 -> L3 -> DRAM 순으로 찾아 데이터를 가져오게됩니다.